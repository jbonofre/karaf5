<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-services">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Services &amp; registry | Apache Karaf 5</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jbonofre.github.io/karaf5//karaf5/docs/services"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Services &amp; registry | Apache Karaf 5"><meta data-rh="true" name="description" content="K5 registry and services are the core of the runtime. Services provided additional features in your runtime, like supporting loading appliccations, starting a HTTP container, etc."><meta data-rh="true" property="og:description" content="K5 registry and services are the core of the runtime. Services provided additional features in your runtime, like supporting loading appliccations, starting a HTTP container, etc."><link data-rh="true" rel="icon" href="/karaf5/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jbonofre.github.io/karaf5//karaf5/docs/services"><link data-rh="true" rel="alternate" href="https://jbonofre.github.io/karaf5//karaf5/docs/services" hreflang="en"><link data-rh="true" rel="alternate" href="https://jbonofre.github.io/karaf5//karaf5/docs/services" hreflang="x-default"><link rel="stylesheet" href="/karaf5/assets/css/styles.9ea7d257.css">
<link rel="preload" href="/karaf5/assets/js/runtime~main.c921dff6.js" as="script">
<link rel="preload" href="/karaf5/assets/js/main.5e819d2b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/karaf5/"><div class="navbar__logo"><img src="/karaf5/img/logo.png" alt="Apache Karaf 5" class="themedImage_ToTc themedImage--light_HNdA"><img src="/karaf5/img/logo.png" alt="Apache Karaf 5" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/karaf5/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/karaf5/download">Download</a><a class="navbar__item navbar__link" href="/karaf5/creator">Creator</a><a class="navbar__item navbar__link" href="/karaf5/examples">Examples</a><a href="https://github.com/jbonofre/karaf5" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/karaf5/docs/intro">Welcome to K5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/karaf5/docs/getting_started">Getting started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/karaf5/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/karaf5/docs/services">Services &amp; registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/karaf5/docs/tools">Tools</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/karaf5/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Services &amp; registry</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Services &amp; registry</h1><p>K5 registry and services are the core of the runtime. Services provided additional features in your runtime, like supporting loading appliccations, starting a HTTP container, etc.</p><p>Basically, a runtime is modules loader, easy module register services in the K5 service registry.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="k5-service">K5 service<a class="hash-link" href="#k5-service" title="Direct link to heading">​</a></h2><p>A service is a &quot;classic&quot; Java SPI: a service is described by a Java interface.</p><p>Any module in a K5 runtime can use and register services.</p><p>A service can:</p><ul><li>have a name (default is class simple name)</li><li>have a priority (if you want to define an order between services or defining a kind of starting stages by grouping services).</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="k5-registry--loading-services">K5 registry &amp; loading services<a class="hash-link" href="#k5-registry--loading-services" title="Direct link to heading">​</a></h2><p>The K5 Service Registry stores any K5 services. The registry is basically a <code>Map&lt;Class&lt;?&gt;, Service&gt;</code>.</p><p>It automatically loads K5 services: the services loading can be &quot;ordered&quot; by priority in the registry.</p><p>K5 Service Registry is unique in a runtime and shared by any services/applications present in the runtime.</p><p>The K5 service registration give you access to the Service Registry, and you can interact with it. You also have util method to get the K5 Service Registry without registrering a service.</p><p>Once you have the Service Registry, you can:</p><ul><li>get any service from the registry (including the K5 core services)</li><li>get all services from a certain type (interface)</li><li>registry your own services</li><li>unregister any service</li></ul><p>K5 Service Registry service class is <code>org.apache.karaf.boot.service.ServiceRegistry</code>:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class ServiceRegistry implements AutoCloseable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   * Retrieve all services from the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   * @return all services from the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Map&lt;Class&lt;?&gt;, Service&gt; getAll() { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Retrieve a service from the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param serviceClass the service class identifying the service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param &lt;T&gt;          the service type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the service instance from the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public &lt;T&gt; T get(final Class&lt;T&gt; serviceClass) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Lookup a stream of service by type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param serviceClass looked up type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param &lt;T&gt;          expected type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the instances matching the requested type.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public &lt;T&gt; Stream&lt;Service&gt; findByType(final Class&lt;T&gt; serviceClass) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Register a service in the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param service the service to add in the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return true if the service has been added, false else.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean add(final Service service) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Remove a service from the registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param service the service to remove.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void remove(final Service service) { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Close (stop) the service registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void close() { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Start the service registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void start() { ... }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>K5 Service Registry is itself a K5 service.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="core-services">Core services<a class="hash-link" href="#core-services" title="Direct link to heading">​</a></h2><p>Any K5 runtime includes karaf-boot module (runtime core). Karaf Boot provides the core services, provided out of the box for you, available in the service registry.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-service">Configuration service<a class="hash-link" href="#configuration-service" title="Direct link to heading">​</a></h3><p>The configuration service is the main configuration store for the runtime itself, but can also be used by the modules to store their own configurations.</p><p><code>KarafConfigService</code> provides access to the <code>KarafConfig</code> resources:</p><ul><li><em>Properties</em> is key/value pair where you can store anything. These properties can be populated by system properties or environment variables.</li><li><em>Profiles</em> store libaries that you want to share accross several modules in the runtime.</li><li><em>Applications</em> define the properties of your applications modules.</li></ul><p>You can interact with the K5 configuration service programmatically, but you can also populate the configuration via other K5 services, like K5 JSON Configuration or K5 Properties Configuration services. You can also create your own service to populate and interact with the core K5 configuration service.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lifecycle-service">Lifecycle service<a class="hash-link" href="#lifecycle-service" title="Direct link to heading">​</a></h3><p>K5 Lifecycle service allows you to &quot;hook&quot; your own services into the runtime lifecycle. It allows to call service method during runtime start and stop.</p><p>The lifecycle service is registered in the K5 service registry, it means that starting the service registry is actually starting the lifecycle service.</p><p>You basically have two callback hooks you can create in your service:</p><ul><li>calling one of your service method when the service is registered in the service registry. For that, you just have to implement <code>onRegister(ServiceRegistry serviceRegistry)</code> method in your service:<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public void onRegister(ServiceRegistry serviceRegistry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>once you have the <code>ServiceRegistry</code>, you can add your service methods in the <code>KarafLifeCycleService</code>, in the <code>onStart()</code> and/or <code>onShutdown()</code> phases:<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">KarafLifeCycleService karafLifeCycleService = serviceRegistry.get(KarafLifeCycleService.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">karafLifeCycleService.onStart(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">karafLifeCycleService.onShutdown(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // shutdow </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">});</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>The runtime start cinetic is:</p><ol><li>Load and register all services</li><li>Once all services are registered (all <code>onRegister()</code> methods executed), then, the <code>KarafLifeCycleService#start()</code> method is executed, calling all methods registered <code>onStart()</code>.</li></ol><p>On the other hand, the runtime shutdown cinetic is:</p><ol><li>execute <code>KarafLifeCycleService#close()</code> method, calling all methods registered <code>onShutdown()</code></li><li>actually shutdown the runtime.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="classloader-service">Classloader service<a class="hash-link" href="#classloader-service" title="Direct link to heading">​</a></h3><h2 class="anchor anchorWithStickyNavbar_LWe7" id="module-services">Module services<a class="hash-link" href="#module-services" title="Direct link to heading">​</a></h2><p>K5 also provides additional services that you can use &quot;out of the box&quot; to easily create your own services.</p><p>You don&#x27;t have to implement everything, K5 services help you. Loading and using these services is very simple: just add the services in your dependencies (for instance in your Maven <code>pom.xml</code> dependencies) and in the runtime <code>dependencies</code> (classpath).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="banner-k5karaf-banner">Banner (k5:karaf-banner)<a class="hash-link" href="#banner-k5karaf-banner" title="Direct link to heading">​</a></h3><p>Banner service just display a fancy message when the runtime start. To use K5 Banner service, you just have to add <code>k5:karaf-banner</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>You can customize the message using the <code>KARAF_BANNER</code> environment variable or <code>karaf.banner</code> system property.</p><p>For instance, here&#x27;s a <code>karaf-build.json</code> to add the Banner Service in a runtime:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-runtime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;k5:karaf-boot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;k5:banner&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we start <code>my-runtime</code>, you can see the startup message:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ java -jar karaf-boot-5.0-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.Main main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting runtime </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> exploded mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Karaf lib: /Users/jbonofre/test/my-runtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding config </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding classloader-service </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding karaf-banner </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.banner.WelcomeBannerService onRegister</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        __ __                  ____</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       / //_/____ __________ _/ __/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      / ,</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">  / __ </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">/ ___/ __ </span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">/ /_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     / /</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">/ /_/ / /  / /_/ / __/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /_/ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">__,_/_/   </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">__,_/_/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Apache Karaf </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.service.ServiceRegistry lambda</span><span class="token variable" style="color:#36acaa">$start</span><span class="token variable" style="color:#36acaa">$2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:05:25 PM org.apache.karaf.boot.service.KarafLifeCycleService start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting lifecycle </span><span class="token function" style="color:#d73a49">service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, we can try to change the message by settings the <code>KARAF_BANNER</code> environment variable:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">KARAF_BANNER</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Hello K5&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and we can see now our message when launching <code>my-runtime</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ java -jar karaf-boot-5.0-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.Main main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting runtime </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> exploded mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Karaf lib: /Users/jbonofre/test/my-runtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding config </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding classloader-service </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding karaf-banner </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.banner.WelcomeBannerService onRegister</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Welcome K5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.service.ServiceRegistry lambda</span><span class="token variable" style="color:#36acaa">$start</span><span class="token variable" style="color:#36acaa">$2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 02, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">:07:58 PM org.apache.karaf.boot.service.KarafLifeCycleService start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting lifecycle </span><span class="token function" style="color:#d73a49">service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="camel-k5karaf-camel">Camel (k5:karaf-camel)<a class="hash-link" href="#camel-k5karaf-camel" title="Direct link to heading">​</a></h3><p>You want to run <a href="https://camel.apache.org" target="_blank" rel="noopener noreferrer">Apache Camel</a> routes in your K5 runtime, K5 Camel service can help you. To use K5 Camel service, you just have to add <code>k5:karaf-camel</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>The K5 Camel service automatically creates a <code>CamelContext</code> for you. Then, you can directly create the Camel routes as K5 service and they will be automatically added to the <code>CamelContext</code>.</p><p>For instance, your Camel route service can look like:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class MyRouteBuilder extends RouteBuilder implements Service {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String name() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;test-route&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void configure() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from(&quot;direct:test&quot;).id(name()).to(&quot;log:test&quot;).to(&quot;mock:test&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Don&#x27;t worry about the version, the K5 service modules provide all &quot;verified&quot; dependencies running in K5. For instance, if you use Apache Maven, you just need these dependencies:</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">my.group.id</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">my-route</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.karaf</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">karaf-boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.karaf</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">karaf-camel</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.maven.plugins</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">maven-compiler-plugin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">11</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">11</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using Apache Maven, just build your route project with <code>mvn clean install</code>.</p><p>Now, you can create the following <code>karaf-build.json</code>, optionally overriding Camel dependencies: </p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-runtime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;include.transitive&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;k5:boot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;k5:camel&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;mvn:org.apache.camel/camel-core/3.17.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;mvn:my.group.id/my-route/1.0-SNAPSHOT&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Instead of using <code>karaf-build</code> CLI, you can also use directly the <code>karaf-maven-plugin</code> to easily create the runtime based on your Maven project.</em></p><p>When we launch <code>my-runtime</code>, we can see the Camel route started:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ java -jar karaf-boot-5.0-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.774343000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Adding config </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.812901000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Adding lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.813346000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Adding test-route </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.813705000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Adding karaf-camel </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1001</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.814024000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.camel.CamelService onRegister </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Creating default CamelContext</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.934149000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.camel.CamelService onRegister </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Looking </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token for-or-select variable" style="color:#36acaa">RouteBuilder</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> the registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.975948000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.ServiceRegistry lambda</span><span class="token variable" style="color:#36acaa">$start</span><span class="token variable" style="color:#36acaa">$2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Starting services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:01.976382000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.KarafLifeCycleService start </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Starting lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.140007000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.impl.engine.AbstractCamelContext doStartContext </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Apache Camel </span><span class="token number" style="color:#36acaa">3.17</span><span class="token plain">.0 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default-camel-context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> is starting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.163201000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.impl.engine.AbstractCamelContext logStartSummary </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Routes startup </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">total:1 started:1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.163682000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.impl.engine.AbstractCamelContext logStartSummary </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain">     Started test-route </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direct://test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.164197000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.impl.engine.AbstractCamelContext logStartSummary </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Apache Camel </span><span class="token number" style="color:#36acaa">3.17</span><span class="token plain">.0 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default-camel-context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> started </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 245ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">build:60ms init:161ms start:24ms</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.190766000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.spi.CamelLogger log </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Exchange</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ExchangePattern: InOnly, BodyType: String, Body: Hello K5</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.196397000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.component.mock.MockEndpoint assertIsSatisfied </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Asserting: mock://test is satisfied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.196985000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.ServiceRegistry close </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Closing </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.198728000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.karaf.boot.service.KarafLifeCycleService close </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Stopping lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.200030000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.impl.engine.AbstractCamelContext doStop </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Apache Camel </span><span class="token number" style="color:#36acaa">3.17</span><span class="token plain">.0 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default-camel-context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> shutting down </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timeout:45s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.221227000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.spi.CamelLogger log </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Routes stopped </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">total:1 stopped:1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.221589000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.spi.CamelLogger log </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain">     Stopped test-route </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">direct://test</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-10-02 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:46:02.224676000 INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> org.apache.camel.impl.engine.AbstractCamelContext doStop </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> Apache Camel </span><span class="token number" style="color:#36acaa">3.17</span><span class="token plain">.0 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default-camel-context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">shutdown</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> 25ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uptime:84ms</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cdi-modules-manager-k5karaf-cdi">CDI Modules manager (k5:karaf-cdi)<a class="hash-link" href="#cdi-modules-manager-k5karaf-cdi" title="Direct link to heading">​</a></h3><p><em>Coming soon!</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="classpath-k5karaf-classpath">Classpath (k5:karaf-classpath)<a class="hash-link" href="#classpath-k5karaf-classpath" title="Direct link to heading">​</a></h3><p>K5 Classpath service provides a protocol handler allowing you to use <code>classpath:</code> protocol in your modules. To use K5 Classpath service, you just have to add <code>k5:karaf-classpath</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>You just need to have <code>k5:karaf-classpath</code> service in your <code>karaf-build.json</code> <code>dependencies</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-json-k5karaf-config-json">Configuration JSON (k5:karaf-config-json)<a class="hash-link" href="#configuration-json-k5karaf-config-json" title="Direct link to heading">​</a></h3><p>K5 Configuration JSON allows you to populate the K5 Configuration Service using a JSON file. To use K5 Configuration JSON service, you just have to add <code>k5:karaf-config-json</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>As soon as you add <code>k5:karaf-config-json</code> module in your runtime, you can also include a <code>karaf.json</code> file.</p><p><em>You can also define the location of the <code>karaf.json</code> file using <code>KARAF_CONFIG</code> environment variable or <code>karaf.config</code> system property.</em></p><p>The <code>karaf.json</code> populates the <code>KarafConfigService</code>, with <code>properties</code>, <code>profiles</code>, <code>applications</code>. For instance:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;foo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;lifecycle.enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;log.patternLayout&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%m %n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;profiles&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;myprofile&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;foo&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;urls&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/to/jar/file.jar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/to/folder&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;applications&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;spring-boot-foo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1.0-SNAPSHOT&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/to/app/spring-boot.jar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;profile&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;myprofile&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;spring-boot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;properties&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;enableHttp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">&quot;enablePrometheus&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bundle-bar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/path/to/osgi/bundle.jar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;osgi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-properties-k5karaf-config-properties">Configuration Properties (k5:karaf-config-properties)<a class="hash-link" href="#configuration-properties-k5karaf-config-properties" title="Direct link to heading">​</a></h3><p>K5 Configuration Properties allows you to populate the K5 Configuration Service using a Properties file. To use K5 Configurtion Properties service, you just have to add <code>k5:karaf-config-properties</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>As soon as you add <code>k5:karaf-config-properties</code> module in your runtime, you can also include a <code>karaf.properties</code> file.</p><p><em>You can also define the location of the <code>karaf.properties</code> file using <code>KARAF_CONFIG</code> environment variable or <code>karaf.config</code> system property.</em></p><p>The <code>karaf.properties</code> populates the <code>KarafConfigService</code>, with <code>properties</code>, <code>profiles</code>, <code>applications</code>. For instance:</p><div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lifecycle.enabled=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log.patternLayout=%m %n</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app1.url=/path/to/app/spring-boot.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app1.profiles=myprofile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app1.type=spring-boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app1.enableHttp=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app1.enablePrometheus=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app2.url=/path/to/osgi/bundle.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application.app2.type=osgi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extractor-k5karaf-extractor">Extractor (k5:karaf-extractor)<a class="hash-link" href="#extractor-k5karaf-extractor" title="Direct link to heading">​</a></h3><p>K5 Extractor service is able to extract/copy folder to the location of your choice. To use K5 Extractor service, you just have to add <code>k5:karaf-extractor</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>The extraction process is performed at register time.</p><p>The Extractor service uses properties (from the <code>KarafConfig</code> service):</p><ul><li><code>extractor.target</code> property (default is the current folder) is the target directory where the resources will be copied/extractor.</li><li><code>extractor.sources</code> property (default is <code>resources</code> folder) is a list of source directories where to read the resources.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-k5karaf-http">HTTP (k5:karaf-http)<a class="hash-link" href="#http-k5karaf-http" title="Direct link to heading">​</a></h3><p>K5 HTTP service starts a HTTP container (powered by Jetty) where you can deploy your servlets. To use K5 HTTP service, you just have to add <code>k5:karaf-http</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>You can configure the HTTP container via <code>KarafConfig</code> properties:</p><ul><li><code>http.maxThreads</code></li><li><code>http.minThreads</code></li><li><code>http.idleTimeout</code></li><li><code>http.acceptors</code></li><li><code>http.selectors</code></li><li><code>http.port</code></li><li><code>http.host</code></li><li><code>http.acceptQueueSize</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jmx-k5karaf-jmx">JMX (k5:karaf-jmx)<a class="hash-link" href="#jmx-k5karaf-jmx" title="Direct link to heading">​</a></h3><p><em>Coming soon!</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jpa-k5karaf-jpa">JPA (k5:karaf-jpa)<a class="hash-link" href="#jpa-k5karaf-jpa" title="Direct link to heading">​</a></h3><p>K5 JPA service provides a JPA engine (powered by OpenJPA) mapping your data beans with a database. To use K5 JPA service, you just have to add <code>k5:karaf-jpa</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>K5 JPA service start the JPA engine at register time. Then, you can get the JPA service to get the JPA <code>EntityManager</code> to register your JPA entities.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="osgi-modules-manager-k5karaf-osgi">OSGi modules manager (k5:karaf-osgi)<a class="hash-link" href="#osgi-modules-manager-k5karaf-osgi" title="Direct link to heading">​</a></h3><p>K5 OSGi Modules manager add support of OSGi bundles in your runtime. To enable OSGi support, you have to add <code>k5:karaf-osgi</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>It uses <code>KarafConfig</code> service to retrieve the OSGi <code>applications</code> to be deployed and started in the runtime.</p><p>For instance, using <code>karaf-config-json</code> module, you can configure the list of OSGi bundles part of your runtime:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;applications&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://repo1.maven.org/maven2/commons-lang/commons-lang/2.6/commons-lang-2.6.jar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;osgi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>NOTE: K5 OSGi Modules Manager tries to automatically detect when an artifact is an OSGi bundle (so <code>type</code> is optional). However, defining application <code>type</code> as <code>osgi</code> is recommended to force K5 OSGi modules manager to handle the artifact.</em></p><p>Here, <code>commons-lang-2.6.jar</code> will be installed as an OSGi bundle into the K5 OSGi modules manager.</p><p>The location (<code>url</code>) of the OSGi modules can be remote (using <code>http</code>, <code>https</code>, <code>mvn</code>, ...) or local (<code>file</code>).
Of course, you can also package the OSGi module as part of the runtime <code>dependencies</code>, so included in the runtime &quot;out of the box&quot;.</p><p>In details, K5 OSGi modules manager starts an OSGi framework (Apache Felix) and manage the bundles inside the framework.</p><p>You can &quot;tweak&quot; OSGi framework with the following properties:</p><ul><li><code>osgi.storageDirectory</code></li><li><code>osgi.clearCache</code></li><li><code>osgi.startLevel</code></li><li><code>osgi.bundleStartLevel</code></li><li><code>osgi.logLevel</code></li><li><code>osgi.cache</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="microprofile-modules-manager-k5karaf-microprofile">Microprofile modules manager (k5:karaf-microprofile)<a class="hash-link" href="#microprofile-modules-manager-k5karaf-microprofile" title="Direct link to heading">​</a></h3><p><em>Coming soon!</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rest-k5karaf-rest">REST (k5:karaf-rest)<a class="hash-link" href="#rest-k5karaf-rest" title="Direct link to heading">​</a></h3><p>K5 REST service provides JAX-RS REST API support (powered by Jersey). To use K5 REST service, you just have to add <code>k5:karaf-rest</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>K5 REST service uses <code>KarafConfig</code> <code>rest.packages</code> property to define the packages where to look for JAX-RS resources.</p><p>Optionally, K5 REST service can use <code>rest.path</code> property to define where the REST resources are exposed (by default it&#x27;s <code>/rest/*</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spring-boot-modules-manager-k5karaf-spring-boot">Spring Boot modules manager (k5:karaf-spring-boot)<a class="hash-link" href="#spring-boot-modules-manager-k5karaf-spring-boot" title="Direct link to heading">​</a></h3><p>K5 runtime can collocate multiple Spring Boot modules (applications). To add Spring Boot support, you have to load <code>k5:karaf-spring-boot</code> module in your runtime <code>dependencies</code> (or classpath).</p><p>It uses <code>KarafConfig</code> service to retrieve the Spring Boot <code>applications</code> to be started in the runtime.</p><p>For instance, using <code>karaf-config-json</code>, you can configure the list of Spring Boot modules part of your runtime:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;applications&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;file:./lib/spring-petclinic.jar&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;spring-boot&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>NOTE: K5 Spring Boot Modules Manager tries to automatically detect a Spring Boot artifact. However, defining application <code>type</code> as <code>spring-boot</code> is recommended to force K5 Spring Boot modules manager to handle the artifact.</em></p><p>Here, we deploy the Spring Boot PetClinic demo application in our runtime.</p><p>The location (<code>url</code>) of the Spring Boot modules can be remote (using <code>http</code>, <code>https</code>, <code>mvn</code>, ...) or local (<code>file</code>).
Of course, you can also package the Spring Boot module as part of the runtime <code>dependencies</code>, so included in the runtime &quot;out of the box&quot;.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="shell-k5karaf-shell">Shell (k5:karaf-shell)<a class="hash-link" href="#shell-k5karaf-shell" title="Direct link to heading">​</a></h3><p>K5 Shell provides a full Unix like shell environment where you can interact your runtime: listing services from the registry, manipulating application modules, ...</p><p><em>Coming soon!</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-service">Create a service<a class="hash-link" href="#create-a-service" title="Direct link to heading">​</a></h2><p>You can create your own K5 service. It&#x27;s very easy.</p><p>To create your K5 service, you just have to write a class implementing <code>org.apache.karaf.boot.spi.Service</code> interface:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Generic Karaf Service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface Service {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int DEFAULT_PRIORITY = 1000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Register a service in the Karaf registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param serviceRegistry the Karaf service registry.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @throws Exception if register fails.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void onRegister(final ServiceRegistry serviceRegistry) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // no-op, service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Retrieve the service priority (allow services sorting).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Default is 1000.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the service priority.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default int priority() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return DEFAULT_PRIORITY;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Retrieve the service name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Default is the service simple class name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the service name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default String name() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return getClass().getSimpleName().toLowerCase(Locale.ROOT).replaceAll(&quot;Service&quot;, &quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Add properties specific to a service that could be used by other services during lookup.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Default is empty properties.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the service properties.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    default Properties properties() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Properties();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here&#x27;s a very simple <code>MyService</code>:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package k5.my.service;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.karaf.boot.service.ServiceRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.karaf.boot.spi.Service;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyService implements Service {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String name() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;my-service&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void onRegister(ServiceRegistry serviceRegistry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;HELLLLOOOOO K5 !&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, you have to define your service implementation (for the Service Loader) in <code>META-INF/services/org.apache.karaf.boot.spi.Service</code> file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">k5.my.service.MyService</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can use the following Maven <code>pom.xml</code> to build your service jar:</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">net.nanthrax.test</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">k5-my-service</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.karaf</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">karaf-boot</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">5.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.maven.plugins</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">maven-compiler-plugin</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">11</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">source</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">11</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">target</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">configuration</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugin</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plugins</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">build</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can create a runtime with your service using the following <code>karaf-build.json</code> file:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-runtime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;k5:karaf-boot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;mvn:net.nanthrax.test/k5-my-service/1.0-SNAPSHOT&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, you can launch the runtime and we see our service registered:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -jar karaf-boot-5.0-SNAPSHOT.jar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.Main main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting runtime </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> exploded mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Karaf lib: /Users/jbonofre/test/my-runtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding config </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding classloader-service </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Adding my-service </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HELLLLOOOOO K5 </span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.service.ServiceRegistry lambda</span><span class="token variable" style="color:#36acaa">$start</span><span class="token variable" style="color:#36acaa">$2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oct. 03, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">:08:07 PM org.apache.karaf.boot.service.KarafLifeCycleService start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFOS: Starting lifecycle </span><span class="token function" style="color:#d73a49">service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s now extend the service by adding callback in the K5 Lifecycle service.</p><p>To &quot;hook&quot; in the K5 Lifecycle service, we have to:</p><ul><li>get the <code>KarafLifecycleService</code> from the <code>ServiceRegistry</code> in the <code>onRegister()</code> method of our service</li><li>register callback method in <code>KarafLifeCycleService</code> <code>onStart()</code> and <code>onShutdown()</code> hooks</li></ul><p>Basically, <code>MyService</code> could look like:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package k5.my.service;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.karaf.boot.service.KarafLifeCycleService;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.karaf.boot.service.ServiceRegistry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.apache.karaf.boot.spi.Service;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyService implements Service {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String name() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;my-service&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void onRegister(ServiceRegistry serviceRegistry) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;Hello K5!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        KarafLifeCycleService karafLifeCycleService = serviceRegistry.get(KarafLifeCycleService.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        karafLifeCycleService.onStart(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Hey, my-service is starting !&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        karafLifeCycleService.onShutdown(() -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;Hey, my-service is shutting down!&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After updating <code>my-runtime</code>, at launch we can see the start/shudown hooks called:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">java -jar karaf-boot-5.0-SNAPSHOT.jar                                                                                                                                             </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.Main main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Starting runtime </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> exploded mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Karaf lib: /home/jbonofre/test/my-runtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Adding config </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-2147483647</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Adding lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Adding classloader-service </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">-1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.service.ServiceRegistry </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Adding my-service </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello K5</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.service.ServiceRegistry lambda</span><span class="token variable" style="color:#36acaa">$start</span><span class="token variable" style="color:#36acaa">$2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Starting services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oct 04, </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:01:05 PM org.apache.karaf.boot.service.KarafLifeCycleService start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Starting lifecycle </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hey, my-service is starting </span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/karaf5/docs/architecture"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/karaf5/docs/tools"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tools</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#k5-service" class="table-of-contents__link toc-highlight">K5 service</a></li><li><a href="#k5-registry--loading-services" class="table-of-contents__link toc-highlight">K5 registry &amp; loading services</a></li><li><a href="#core-services" class="table-of-contents__link toc-highlight">Core services</a><ul><li><a href="#configuration-service" class="table-of-contents__link toc-highlight">Configuration service</a></li><li><a href="#lifecycle-service" class="table-of-contents__link toc-highlight">Lifecycle service</a></li><li><a href="#classloader-service" class="table-of-contents__link toc-highlight">Classloader service</a></li></ul></li><li><a href="#module-services" class="table-of-contents__link toc-highlight">Module services</a><ul><li><a href="#banner-k5karaf-banner" class="table-of-contents__link toc-highlight">Banner (k5:karaf-banner)</a></li><li><a href="#camel-k5karaf-camel" class="table-of-contents__link toc-highlight">Camel (k5:karaf-camel)</a></li><li><a href="#cdi-modules-manager-k5karaf-cdi" class="table-of-contents__link toc-highlight">CDI Modules manager (k5:karaf-cdi)</a></li><li><a href="#classpath-k5karaf-classpath" class="table-of-contents__link toc-highlight">Classpath (k5:karaf-classpath)</a></li><li><a href="#configuration-json-k5karaf-config-json" class="table-of-contents__link toc-highlight">Configuration JSON (k5:karaf-config-json)</a></li><li><a href="#configuration-properties-k5karaf-config-properties" class="table-of-contents__link toc-highlight">Configuration Properties (k5:karaf-config-properties)</a></li><li><a href="#extractor-k5karaf-extractor" class="table-of-contents__link toc-highlight">Extractor (k5:karaf-extractor)</a></li><li><a href="#http-k5karaf-http" class="table-of-contents__link toc-highlight">HTTP (k5:karaf-http)</a></li><li><a href="#jmx-k5karaf-jmx" class="table-of-contents__link toc-highlight">JMX (k5:karaf-jmx)</a></li><li><a href="#jpa-k5karaf-jpa" class="table-of-contents__link toc-highlight">JPA (k5:karaf-jpa)</a></li><li><a href="#osgi-modules-manager-k5karaf-osgi" class="table-of-contents__link toc-highlight">OSGi modules manager (k5:karaf-osgi)</a></li><li><a href="#microprofile-modules-manager-k5karaf-microprofile" class="table-of-contents__link toc-highlight">Microprofile modules manager (k5:karaf-microprofile)</a></li><li><a href="#rest-k5karaf-rest" class="table-of-contents__link toc-highlight">REST (k5:karaf-rest)</a></li><li><a href="#spring-boot-modules-manager-k5karaf-spring-boot" class="table-of-contents__link toc-highlight">Spring Boot modules manager (k5:karaf-spring-boot)</a></li><li><a href="#shell-k5karaf-shell" class="table-of-contents__link toc-highlight">Shell (k5:karaf-shell)</a></li></ul></li><li><a href="#create-a-service" class="table-of-contents__link toc-highlight">Create a service</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lists.apache.org/list.html?user@karaf.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">User Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://lists.apache.org/list.html?dev@karaf.apache.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dev Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://the-asf.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/jbonofre/karaf5/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Project</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/jbonofre/karaf5" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/jbonofre/karaf5/actions" target="_blank" rel="noopener noreferrer" class="footer__link-item">CI/CD<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/karaf5/team">Team</a></li><li class="footer__item"><a class="footer__link-item" href="/karaf5/contribute">Contribute</a></li><li class="footer__item"><a class="footer__link-item" href="/karaf5/support">Support</a></li></ul></div><div class="col footer__col"><div class="footer__title">Apache</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">The Apache Software Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://karaf.apache.org/privacy.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Apache Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Licenses<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 - Apache Karaf, Karaf, Apache, the Apache feather logo, and the Apache Karaf project logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/karaf5/assets/js/runtime~main.c921dff6.js"></script>
<script src="/karaf5/assets/js/main.5e819d2b.js"></script>
</body>
</html>